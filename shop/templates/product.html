{% extends "base.html" %}
{% load humanize %}

{% block content %}

<br><br><br><br><br><br>
<div class="card mb-3">
  <div class="row g-0">
    <div class="col-md-4">
      <img src="{{ product.picture.url }}" class="img-fluid rounded-start" alt="{{ product.name }}">
    </div>
    <div class="col-md-8">
      <div class="card-body">
        <h5 class="card-title">{{ product.name }}</h5>
        <p class="card-text">{{ product.description }}</p>

        {% if product.is_sale %}
          <p class="card-text text-danger fw-bold">
            {{ product.sale_price|intcomma }} ØªÙˆÙ…Ø§Ù†
          </p>
          <p class="card-text">ğŸ’°ğŸ’µ Ù‚ÛŒÙ…Øª :
            <del class="text-muted">{{ product.price|intcomma }} ØªÙˆÙ…Ø§Ù†</del>
          </p>
        {% else %}
          <p class="card-text">ğŸ’°ğŸ’µ Ù‚ÛŒÙ…Øª :
            {{ product.price|intcomma|default:"Ù‚ÛŒÙ…Øª Ù†Ø¯Ø§Ø±Ø¯" }} ØªÙˆÙ…Ø§Ù†
          </p>
        {% endif %}
        ØªØ¹Ø¯Ø§Ø¯ :
        <select class="form-select"  id="cart-qty">

  <option value="1">1</option>
  <option value="2">2</option>
  <option value="3">3</option>
</select>

        <br><br>
        <!-- Ø¯Ú©Ù…Ù‡ Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø¨Ø§ Ajax -->
        <button class="btn btn-success" type="button" id="add-cart" data-id="{{ product.id }}">
            Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯
        </button>

        <a href="{% url 'home' %}" class="btn btn-secondary">Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ</a>
      </div>
    </div>
  </div>
</div>

<br><br><br><br><br><br><br><br><br>

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

<script>
$(document).ready(function() {
    $('#add-cart').click(function(e) {
        e.preventDefault();
        var productId = $(this).data('id');

        $.ajax({
            type: 'POST',
            url: '{% url "add_to_cart" product.id %}',
            data: {
                csrfmiddlewaretoken: '{{ csrf_token }}',
            },
            porduct_qty:$('#cart-qty option:selected').text(),
            success: function(response) {
                // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù…
                alert("Ù…Ø­ØµÙˆÙ„ Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯!");

                // Ø¢Ù¾Ø¯ÛŒØª ØªØ¹Ø¯Ø§Ø¯ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ Ø¯Ø± navbar
                if ($("#cart-count").length) {
                    $("#cart-count").text(response.qty);
                }
            },
            error: function(xhr, errmsg, err) {
                console.log(xhr.status + ": " + xhr.responseText);
            }
        });
    });
});
</script>

{% endblock %}
